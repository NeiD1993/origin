
Процедура ОбработкаПроведения(Отказ, Режим)
	//{{__КОНСТРУКТОР_ДВИЖЕНИЙ_РЕГИСТРОВ
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!

	// регистр ДвижениеЭкземпляровКниг
	Движения.ДвижениеЭкземпляровКниг.Записывать = Истина;
	Для Каждого ТекСтрокаКниги Из Книги Цикл
		Движение = Движения.ДвижениеЭкземпляровКниг.Добавить();
		Движение.Период = Дата;
		Движение.ВидКниги = ТекСтрокаКниги.Вид;
		Движение.Сектор = ТекСтрокаКниги.Сектор;
		Движение.Код = ТекСтрокаКниги.Код;
		Движение.РегистрационныйНомер = ТекСтрокаКниги.РегистрационныйНомер;
		Движение.Статус = Перечисления.СтатусКниги.ВНаличии;
		Движение.Название = ТекСтрокаКниги.Название;
		Движение.Автор = ТекСтрокаКниги.Автор;
	КонецЦикла;

	// регистр ДвижениеЭкземпляровКнигПоЧитателям
	Движения.ДвижениеЭкземпляровКнигПоЧитателям.Записывать = Истина;
	Для Каждого ТекСтрокаКниги Из Книги Цикл
		Движение = Движения.ДвижениеЭкземпляровКнигПоЧитателям.Добавить();
		Движение.Период = Дата;
		Движение.Читатель = Читатель;
		Движение.ВидКниги = ТекСтрокаКниги.Вид;
		Движение.Сектор = ТекСтрокаКниги.Сектор;
		Движение.Код = ТекСтрокаКниги.Код;
		Движение.РегистрационныйНомер = ТекСтрокаКниги.РегистрационныйНомер;
		Движение.Статус = Перечисления.СтатусКнигиПоЧитателю.Сдано;
		Движение.Название = ТекСтрокаКниги.Название;
		Движение.Автор = ТекСтрокаКниги.Автор;
	КонецЦикла;

	// регистр ДвижениеШтрафов
	Движения.ДвижениеШтрафов.Записывать = Истина;
	Для Каждого ТекСтрокаКниги Из Книги Цикл
		Если (ТекСтрокаКниги.СуммаШтрафа <> 0) Тогда
			Движение = Движения.ДвижениеШтрафов.Добавить();
			Движение.Период = Дата;
			Движение.Читатель = Читатель;
			Движение.ВидКниги = ТекСтрокаКниги.Вид;
			Движение.Сектор = ТекСтрокаКниги.Сектор;
			Движение.Код = ТекСтрокаКниги.Код;
			Движение.РегистрационныйНомер = ТекСтрокаКниги.РегистрационныйНомер;
			Если (ТекСтрокаКниги.ОплатаШтрафа = Перечисления.ВариантОплатыШтрафа.Оплачивать) Тогда
				Движение.Статус = Перечисления.СтатусОплатыШтрафа.Оплачен;
			Иначе
				Движение.Статус = Перечисления.СтатусОплатыШтрафа.НеОплачен;
			КонецЕсли;
			Движение.СуммаШтрафа = ТекСтрокаКниги.СуммаШтрафа;
		КонецЕсли;
	КонецЦикла;

	//}}__КОНСТРУКТОР_ДВИЖЕНИЙ_РЕГИСТРОВ
КонецПроцедуры
